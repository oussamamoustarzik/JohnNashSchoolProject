<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
</head>
{% include 'Admin/AdminPaiement.html' %}
<style>
  /* Style pour le conteneur du formulaire */
  .form {
    max-width: 800px;
    margin: 0 auto;
    margin-left: 200px; /* Update the margin-left value to adjust the form position */
    padding: 50px;
    box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
  }

  /* Style pour le formulaire */
 

  /* Style pour les étiquettes des champs de saisie */
  
  .label1 input[type="checkbox"] {
    display: block;
    position: absolute;
    margin-top: 10px;
    text-align: right;
    margin-bottom: 5px;
}

  .label1 {
    width: 60%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 3px;
    margin-left: auto;
    margin-bottom: 10px;
  }

  .label1 input[type="checkbox"] {
    margin-right: 5px;
    vertical-align: middle;
  }
  /* Style pour les champs de saisie */
  input, textarea, select {
    width: 60%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 3px;
    margin-left: 160px;
    margin-bottom: 10px; /* Added margin bottom for spacing */
  }

  /* Style pour le bouton */
  button[type="submit"] {
    background-color: #4CAF50;
    color: #fff;
    padding: 10px 20px;
    border: none;
    border-radius: 3px;
    cursor: pointer;
  }

  /* Style pour le bouton lorsqu'il est survolé */
  button[type="submit"]:hover {
    background-color: #3e8e41;
  }

  /* Additional styles to center the form */
  body {
    
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .container {
    width: 100%;
    max-width: 800px;
  }

  
</style>


    
<body>
  <section class="home-section">
 <div class="label1">
  <div class="eleve">
   
    
</div></div>
    <div class="container">
      <section class="main">
        <section class="attendance">
          <div class="attendance-list">
           <br><br><br>
            <form method="POST" class="form">
              {% csrf_token %}
              
              {{ form.as_p }}
              <button type="submit">Submit</button>
            </form>
          </div>
        </section>
      </section>
    </div>
  </section>
  
<script>
  async function fd() {
    let nom = document.querySelector("input[id='id_eleve_nom_prenom']").value;
    document.querySelector('.eleve').innerHTML = '';
    
    if (nom.trim() === '') {
      return; // Don't fetch results if search term is empty
    }
    
    const formData = new FormData();
    formData.append('nom_prenom', nom);
    formData.append('csrfmiddlewaretoken', getCSRFToken());
  
    const response = await fetch('/paiementgeteleve/', {
      method: 'POST',
      body: formData,
    });
  
    data = await response.json();
   
    const eleveBox = document.querySelector('.eleve');
    data.forEach(a => {
      const name = a.nom;
      const prenom = a.prenom;
      const cne = a.eleve__cne_eleve;
      const html = `<div onclick="fillCNE('${cne}', '${name} ${prenom}')">${name} ${prenom} (${cne})</div>`;
      eleveBox.innerHTML += html;
    });
  }
  
  function fillCNE(cne, nomPrenom) {
    const cneInput = document.querySelector("input[id='id_cne_eleve']");
    const nomPrenomInput = document.querySelector("input[id='id_eleve_nom_prenom']");
    cneInput.value = cne;
    nomPrenomInput.value = nomPrenom;
    document.querySelector('.eleve').innerHTML = ''; // Clear the search results
  }
  
  function getCSRFToken() {
    const name = 'csrftoken';
    const cookieValue = document.cookie.split(';')
      .map(c => c.trim())
      .find(c => c.startsWith(`${name}=`));
    if (!cookieValue) {
      return null;
    }
    return decodeURIComponent(cookieValue.substring(name.length + 1));
  }
  
  </script>
  <script>
    $(document).ready(function() {
      // Function to handle the visibility of the fields
      function handleFieldsVisibility() {
        var modeP = $('#id_modeP').val();
        var chequeNomField = $('#id_ChequeNom');
        var chequeNumField = $('#id_ChequeNum');
    
        if (modeP === 'check') {
          chequeNomField.show();
          chequeNumField.show();
        } else {
          chequeNomField.hide();
          chequeNumField.hide();
        }
      }
    
      // Call the function when the modeP field value changes
      $('#id_modeP').on('change', function() {
        handleFieldsVisibility();
      });
    
      // Initially call the function to set the initial visibility
      handleFieldsVisibility();
    });
    </script>
</body>
</html>
